# æ³¨å†Œè¿”å› 500 é”™è¯¯ - æ’æŸ¥æŒ‡å—

## ğŸ” æ—¥å¿—åˆ†æ

ä»ä½ çš„æ—¥å¿—æ¥çœ‹ï¼š

### âœ… æ³¨å†Œå®é™…ä¸ŠæˆåŠŸäº†

**è¯æ®1ï¼šINSERT æˆåŠŸ**
```
==>  Preparing: INSERT INTO users (phone, password, nike_name, breeding_type, position, created_at) VALUES (?, ?, ?, ?, ?, NOW())
==> Parameters: 13812345678(String), 123456(String), 13812345678(String), å…»çŒª(String), è€æ¿(String)
<==    Updates: 1  â† æ’å…¥äº† 1 æ¡è®°å½•ï¼ŒæˆåŠŸï¼
```

**è¯æ®2ï¼šæŸ¥è¯¢åˆ°äº†æ–°ç”¨æˆ·**
```
==>  Preparing: SELECT * FROM users WHERE phone = ?
==> Parameters: 13812345678(String)
<==      Total: 1  â† ç”¨æˆ·å·²å­˜åœ¨
```

### â“ ä½†æ˜¯ä¸ºä»€ä¹ˆè¿”å› 500ï¼Ÿ

å¯èƒ½çš„åŸå› ï¼š
1. å“åº”åºåˆ—åŒ–é—®é¢˜
2. å…¨å±€å¼‚å¸¸å¤„ç†å™¨é—®é¢˜
3. åç»­æ“ä½œæŠ›å‡ºå¼‚å¸¸
4. å‰ç«¯æ”¶åˆ°çš„å¯èƒ½æ˜¯å¦ä¸€ä¸ªè¯·æ±‚çš„å“åº”

---

## ğŸ§ª è¯¦ç»†æµ‹è¯•æ­¥éª¤

### æ­¥éª¤1ï¼šé‡å¯åç«¯ï¼ˆä½¿ç”¨æ–°çš„æ—¥å¿—ä»£ç ï¼‰

```bash
mvn spring-boot:run
```

### æ­¥éª¤2ï¼šä½¿ç”¨ curl è¯¦ç»†æµ‹è¯•

```bash
# ä½¿ç”¨ -v å‚æ•°æŸ¥çœ‹å®Œæ•´çš„è¯·æ±‚å’Œå“åº”
curl -v -X POST http://localhost:8080/user/register \
  -H "Content-Type: application/json" \
  -d '{
    "phone": "13712345678",
    "password": "123456",
    "verifyCode": "123456",
    "breedingType": "å…»çŒª",
    "position": "è€æ¿"
  }'
```

**ä»”ç»†æŸ¥çœ‹è¾“å‡ºï¼š**
1. HTTP çŠ¶æ€ç ï¼ˆåº”è¯¥æ˜¯ 200 æˆ– 500ï¼‰
2. å“åº”ä½“å†…å®¹
3. æ˜¯å¦æœ‰å®Œæ•´çš„ JSON å“åº”

### æ­¥éª¤3ï¼šæŸ¥çœ‹åç«¯æ§åˆ¶å°

**åº”è¯¥çœ‹åˆ°æ–°å¢çš„æ—¥å¿—ï¼š**
```
INFO --- æ”¶åˆ°æ³¨å†Œè¯·æ±‚ï¼Œæ‰‹æœºå·: 13712345678
INFO --- å¼€å§‹æ³¨å†Œç”¨æˆ·ï¼Œæ‰‹æœºå·: 13712345678
INFO --- æ³¨å†ŒæˆåŠŸï¼Œæ‰‹æœºå·: 13712345678, ç”¨æˆ·ID: 4, å½±å“è¡Œæ•°: 1
INFO --- æ³¨å†ŒæˆåŠŸï¼Œå‡†å¤‡è¿”å›å“åº”
INFO --- è¿”å›å“åº”: ApiResponse(code=200, msg=æ³¨å†ŒæˆåŠŸ, data=null)
```

**å¦‚æœçœ‹åˆ°å¼‚å¸¸æ ˆï¼Œè¯´æ˜æŸä¸ªåœ°æ–¹æŠ›å‡ºäº†å¼‚å¸¸**

---

## ğŸ”§ å¯èƒ½çš„é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ

### é—®é¢˜1ï¼šå“åº”åºåˆ—åŒ–å¤±è´¥

**æ£€æŸ¥ ApiResponse æ˜¯å¦æœ‰é—®é¢˜ï¼š**

è®©æˆ‘æµ‹è¯•ä¸€ä¸ªç®€å•çš„æ¥å£ï¼š
```bash
# æµ‹è¯•å‘é€éªŒè¯ç æ¥å£ï¼ˆä¹Ÿè¿”å› ApiResponse<String>ï¼‰
curl -v -X POST http://localhost:8080/user/sendVerifyCode \
  -H "Content-Type: application/json" \
  -d '{"phone":"13712345678"}'
```

å¦‚æœè¿™ä¸ªæ¥å£æ­£å¸¸ï¼Œè¯´æ˜ä¸æ˜¯å“åº”åºåˆ—åŒ–çš„é—®é¢˜ã€‚

### é—®é¢˜2ï¼šå…¨å±€å¼‚å¸¸å¤„ç†å™¨é—®é¢˜

**æµ‹è¯•æ˜¯å¦æ˜¯å¼‚å¸¸å¤„ç†å™¨çš„é—®é¢˜ï¼š**

```bash
# æ•…æ„è§¦å‘ä¸€ä¸ªé”™è¯¯
curl -v -X POST http://localhost:8080/user/register \
  -H "Content-Type: application/json" \
  -d '{
    "phone": "13800138000",
    "password": "123456",
    "verifyCode": "123456",
    "breedingType": "å…»çŒª",
    "position": "è€æ¿"
  }'
```

**é¢„æœŸï¼š** åº”è¯¥è¿”å› "è¯¥æ‰‹æœºå·å·²æ³¨å†Œ"

### é—®é¢˜3ï¼šæ•°æ®åº“å·²æœ‰è¯¥ç”¨æˆ·

ä»æ—¥å¿—çœ‹ï¼Œ13812345678 å·²ç»æ³¨å†ŒæˆåŠŸäº†ã€‚å¦‚æœå†æ¬¡æ³¨å†Œï¼š

```bash
curl -X POST http://localhost:8080/user/register \
  -H "Content-Type: application/json" \
  -d '{
    "phone": "13812345678",
    "password": "123456",
    "verifyCode": "123456",
    "breedingType": "å…»çŒª",
    "position": "è€æ¿"
  }'
```

**åº”è¯¥è¿”å›ï¼š**
```json
{
  "code": 500,
  "msg": "è¯¥æ‰‹æœºå·å·²æ³¨å†Œ",
  "data": null
}
```

---

## ğŸ’¡ æˆ‘çš„åˆ¤æ–­

**æ ¹æ®ä½ çš„æ—¥å¿—ï¼Œæˆ‘è®¤ä¸ºï¼š**

1. **æ³¨å†Œç¡®å®æˆåŠŸäº†** âœ…
   - ç”¨æˆ· 13812345678 å·²ç»æ’å…¥æ•°æ®åº“
   - SQL æ‰§è¡ŒæˆåŠŸ

2. **å¯èƒ½çš„æƒ…å†µï¼š**
   - ä½ ç¬¬ä¸€æ¬¡æ³¨å†ŒæˆåŠŸäº†ï¼ˆè¿”å› 200ï¼‰
   - ä½ ç¬¬äºŒæ¬¡æ³¨å†Œç›¸åŒæ‰‹æœºå·ï¼Œè¿”å› 500ï¼ˆæ‰‹æœºå·å·²æ³¨å†Œï¼‰
   - æˆ–è€…å‰ç«¯è‡ªåŠ¨å‘é€äº†å¤šæ¬¡è¯·æ±‚

3. **éªŒè¯æ–¹æ³•ï¼š**
   ```bash
   # æŸ¥è¯¢æ•°æ®åº“ï¼Œçœ‹ç”¨æˆ·æ˜¯å¦å­˜åœ¨
   mysql -u root -p
   USE iot_system;
   SELECT * FROM users WHERE phone = '13812345678';
   ```
   
   å¦‚æœç”¨æˆ·å­˜åœ¨ï¼Œè¯´æ˜ç¬¬ä¸€æ¬¡æ³¨å†ŒæˆåŠŸäº†ã€‚

---

## ğŸ¯ å»ºè®®çš„æµ‹è¯•æ­¥éª¤

### 1. ä½¿ç”¨å…¨æ–°çš„æ‰‹æœºå·æµ‹è¯•

```bash
curl -v -X POST http://localhost:8080/user/register \
  -H "Content-Type: application/json" \
  -d '{
    "phone": "13999999999",
    "password": "123456",
    "verifyCode": "123456",
    "breedingType": "å…»é¸¡",
    "position": "é¥²å…»å‘˜"
  }'
```

**æŸ¥çœ‹ï¼š**
- HTTP çŠ¶æ€ç 
- å“åº”ä½“
- åç«¯æ§åˆ¶å°æ—¥å¿—

### 2. æŸ¥çœ‹å®Œæ•´çš„é”™è¯¯ä¿¡æ¯

å¦‚æœè¿”å› 500ï¼ŒæŸ¥çœ‹å“åº”ä½“ä¸­çš„ `msg` å­—æ®µï¼Œå®ƒä¼šå‘Šè¯‰ä½ å…·ä½“çš„é”™è¯¯åŸå› ã€‚

### 3. æ£€æŸ¥æ•°æ®åº“

```sql
SELECT * FROM users ORDER BY created_at DESC LIMIT 5;
```

æŸ¥çœ‹æœ€æ–°æ³¨å†Œçš„ç”¨æˆ·ã€‚

---

## ğŸ“ è¯·æä¾›ä»¥ä¸‹ä¿¡æ¯

ä¸ºäº†å¸®ä½ ç²¾ç¡®å®šä½é—®é¢˜ï¼Œè¯·æ‰§è¡Œå¹¶æä¾›ï¼š

### 1. æµ‹è¯•å…¨æ–°æ‰‹æœºå·çš„å®Œæ•´å“åº”

```bash
curl -v -X POST http://localhost:8080/user/register \
  -H "Content-Type: application/json" \
  -d '{
    "phone": "13988888888",
    "password": "123456",
    "verifyCode": "123456",
    "breedingType": "å…»çŒª",
    "position": "è€æ¿"
  }'
```

**æä¾›ï¼š**
- HTTP çŠ¶æ€ç ï¼ˆ< HTTP/1.1 XXXï¼‰
- å“åº”ä½“å†…å®¹
- åç«¯æ§åˆ¶å°çš„å®Œæ•´æ—¥å¿—

### 2. æ•°æ®åº“æŸ¥è¯¢ç»“æœ

```sql
SELECT phone, nike_name, breeding_type, position, created_at 
FROM users 
ORDER BY created_at DESC;
```

---

## ğŸ› ï¸ ä¸´æ—¶è§£å†³æ–¹æ¡ˆ

å¦‚æœç¡®å®æ˜¯å“åº”è¿”å›æ—¶çš„é—®é¢˜ï¼Œå¯ä»¥æš‚æ—¶ä¿®æ”¹ä¸ºè¿”å›æ›´ç®€å•çš„å“åº”ï¼š

```java
@PostMapping("/register")
public Map<String, Object> register(@Valid @RequestBody RegisterRequest request) {
    userService.register(request);
    Map<String, Object> result = new HashMap<>();
    result.put("code", 200);
    result.put("msg", "æ³¨å†ŒæˆåŠŸ");
    result.put("data", null);
    return result;
}
```

---

## ğŸ¯ ä¸‹ä¸€æ­¥

è¯·é‡å¯åç«¯ï¼ˆåº”ç”¨æ–°çš„æ—¥å¿—ä»£ç ï¼‰ï¼Œç„¶åï¼š

1. ä½¿ç”¨**å…¨æ–°çš„æ‰‹æœºå·**æµ‹è¯•æ³¨å†Œ
2. æä¾›**å®Œæ•´çš„ curl -v è¾“å‡º**
3. æä¾›**åç«¯æ§åˆ¶å°çš„æ—¥å¿—**

è¿™æ ·æˆ‘å°±èƒ½å‡†ç¡®æ‰¾åˆ°é—®é¢˜æ‰€åœ¨ï¼ğŸ“‹

