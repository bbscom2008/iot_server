<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.example.demo.mapper.FrequencyMotorMapper">

    <resultMap id="BaseResultMap" type="com.example.demo.entity.FrequencyMotor">
        <id column="id" property="id" jdbcType="BIGINT"/>
        <result column="device_id" property="deviceId" jdbcType="BIGINT"/>
        <result column="device_num" property="deviceNum" jdbcType="VARCHAR"/>
        <result column="name" property="name" jdbcType="VARCHAR"/>
        <result column="protect_speed" property="protectSpeed" jdbcType="DECIMAL"/>
        <result column="is_auto" property="isAuto" jdbcType="INTEGER"/>
        <result column="manual_speed" property="manualSpeed" jdbcType="DECIMAL"/>
        <result column="value" property="value" jdbcType="INTEGER"/>
        <result column="run_time" property="runTime" jdbcType="INTEGER"/>
        <result column="pause_time" property="pauseTime" jdbcType="INTEGER"/>
        <result column="control_type" property="controlType" jdbcType="INTEGER"/>
        <result column="temp_sensor_id" property="tempSensorId" jdbcType="BIGINT"/>
        <result column="temp_upper" property="tempUpper" jdbcType="DECIMAL"/>
        <result column="temp_lower" property="tempLower" jdbcType="DECIMAL"/>
        <result column="humidity_upper" property="humidityUpper" jdbcType="DECIMAL"/>
        <result column="humidity_lower" property="humidityLower" jdbcType="DECIMAL"/>
        <result column="gas_upper" property="gasUpper" jdbcType="DECIMAL"/>
        <result column="gas_lower" property="gasLower" jdbcType="DECIMAL"/>
        <result column="created_time" property="createdTime" jdbcType="TIMESTAMP"/>
        <result column="updated_time" property="updatedTime" jdbcType="TIMESTAMP"/>
    </resultMap>

    <!-- 根据设备ID查询所有变频电机 -->
    <select id="findByDeviceId" resultMap="BaseResultMap">
        SELECT * FROM frequency_motor
        WHERE device_id = #{deviceId}
        ORDER BY id ASC
    </select>

    <!-- 根据设备编号查询所有变频电机 -->
    <select id="findByDeviceNum" resultMap="BaseResultMap">
        SELECT * FROM frequency_motor
        WHERE device_num = #{deviceNum}
        ORDER BY id ASC
    </select>

    <!-- 根据ID查询变频电机 -->
    <select id="findById" resultMap="BaseResultMap">
        SELECT * FROM frequency_motor WHERE id = #{id}
    </select>

    <!-- 新增变频电机 -->
    <insert id="insert" useGeneratedKeys="true" keyProperty="id">
        INSERT INTO frequency_motor 
        (device_id, device_num, name, protect_speed, is_auto, manual_speed, value, run_time, pause_time, 
         control_type, temp_sensor_id, temp_upper, temp_lower, humidity_upper, humidity_lower, gas_upper, gas_lower, 
         created_time, updated_time)
        VALUES 
        (#{deviceId}, #{deviceNum}, #{name}, #{protectSpeed}, #{isAuto}, #{manualSpeed}, #{value}, #{runTime}, #{pauseTime},
         #{controlType}, #{tempSensorId}, #{tempUpper}, #{tempLower}, #{humidityUpper}, #{humidityLower}, #{gasUpper}, #{gasLower},
         NOW(), NOW())
    </insert>

    <!-- 更新变频电机配置 -->
    <update id="update">
        UPDATE frequency_motor
        SET protect_speed = #{protectSpeed},
            is_auto = #{isAuto},
            manual_speed = #{manualSpeed},
            value = #{value},
            run_time = #{runTime},
            pause_time = #{pauseTime},
            control_type = #{controlType},
            temp_sensor_id = #{tempSensorId},
            temp_upper = #{tempUpper},
            temp_lower = #{tempLower},
            humidity_upper = #{humidityUpper},
            humidity_lower = #{humidityLower},
            gas_upper = #{gasUpper},
            gas_lower = #{gasLower},
            updated_time = NOW()
        WHERE id = #{id}
    </update>

    <!-- 删除变频电机 -->
    <delete id="deleteById">
        DELETE FROM frequency_motor WHERE id = #{id}
    </delete>

    <!-- 删除设备的所有变频电机 -->
    <delete id="deleteByDeviceId">
        DELETE FROM frequency_motor WHERE device_id = #{deviceId}
    </delete>

</mapper>

