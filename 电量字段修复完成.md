# ç”µé‡å­—æ®µä¿®å¤ - å®Œæˆ âœ…

## ğŸ¯ é—®é¢˜

å‰ç«¯ä½¿ç”¨äº† `electricQuantity`ï¼ˆç”µé‡ï¼‰å­—æ®µï¼Œä½†åç«¯æ²¡æœ‰è¿”å›è¿™ä¸ªå­—æ®µã€‚

**å‰ç«¯ä½¿ç”¨ä½ç½®ï¼š**
1. `components/tab-views/home.vue` - ç¬¬62è¡Œ
   ```javascript
   item.electricQuantity > 20  // åˆ¤æ–­ç”µé‡æ˜¯å¦å……è¶³
   ```

2. `pages/equipmentDetails/equipmentDetails.vue` - ç¬¬42è¡Œ
   ```javascript
   deviceInfo.electricQuantity || '93'  // æ˜¾ç¤ºç”µé‡ç™¾åˆ†æ¯”
   ```

3. `pages/particulars/particulars.vue` - ç¬¬26è¡Œ
   ```javascript
   deviceInfo.electricQuantity  // æ˜¾ç¤ºç”µé‡å€¼
   ```

---

## âœ… å·²å®Œæˆçš„ä¿®æ”¹

### 1. Device å®ä½“ç±»

**æ–‡ä»¶ï¼š** `src/main/java/com/example/demo/entity/Device.java`

```java
private Integer electricQuantity; // ç”µé‡ï¼ˆ0-100ï¼‰
```

### 2. DeviceMapper.xml

**æ–‡ä»¶ï¼š** `src/main/resources/mapper/DeviceMapper.xml`

```xml
<result column="electric_quantity" property="electricQuantity" jdbcType="INTEGER"/>
```

### 3. æ•°æ®åº“è¡¨

**æ–‡ä»¶ï¼š** `iot_database_init.sql`

```sql
electric_quantity INT DEFAULT 100 COMMENT 'ç”µé‡ï¼ˆ0-100ï¼‰',
```

### 4. æµ‹è¯•æ•°æ®

| è®¾å¤‡ | ç”µé‡ | è¯´æ˜ |
|------|------|------|
| DEV001 | 85% | ç”µé‡å……è¶³ âœ… |
| DEV002 | 93% | ç”µé‡å……è¶³ âœ… |
| DEV003 | 15% | ç”µé‡ä½ âš ï¸ |
| DEV004 | 72% | ç”µé‡æ­£å¸¸ âœ… |

---

## ğŸ”„ å¦‚ä½•åº”ç”¨

### æƒ…å†µ1ï¼šè¿˜æ²¡æœ‰åˆ›å»ºæ•°æ®åº“

ç›´æ¥æ‰§è¡Œï¼š
```bash
mysql -u root -p < iot_database_init.sql
```

### æƒ…å†µ2ï¼šæ•°æ®åº“å·²å­˜åœ¨

**æ–¹å¼Aï¼šé‡æ–°åˆ›å»ºï¼ˆæ¨èï¼Œæ•°æ®ä¼šæ¸…ç©ºï¼‰**
```sql
DROP DATABASE IF EXISTS iot_system;
source iot_database_init.sql;
```

**æ–¹å¼Bï¼šåªæ·»åŠ å­—æ®µï¼ˆä¿ç•™æ•°æ®ï¼‰**
```bash
mysql -u root -p < update_add_electric_quantity.sql
```

æˆ–æ‰‹åŠ¨æ‰§è¡Œï¼š
```sql
ALTER TABLE devices 
ADD COLUMN electric_quantity INT DEFAULT 100 COMMENT 'ç”µé‡ï¼ˆ0-100ï¼‰' 
AFTER gas_con;
```

### ç„¶åé‡å¯åç«¯

```bash
mvn spring-boot:run
```

---

## ğŸ§ª éªŒè¯

### æµ‹è¯•æ¥å£

```bash
# 1. ç™»å½•
curl -X POST http://localhost:8080/user/login \
  -H "Content-Type: application/json" \
  -d '{"phone":"13800138000","password":"123456"}'

# 2. è·å–è®¾å¤‡åˆ—è¡¨
curl -X GET "http://localhost:8080/device/list?pageNum=1&pageSize=10" \
  -H "Authorization: ä½ çš„token"
```

### é¢„æœŸå“åº”

```json
{
  "code": 200,
  "msg": "success",
  "data": {
    "list": [
      {
        "id": 1,
        "userId": 1,
        "deviceNum": "DEV001",
        "deviceName": "1å·çŒªèˆæŠ¥è­¦å™¨",
        "deviceType": 0,
        "breedType": 0,
        "deviceLineState": 1,
        "signal": 3,
        "ta": 25.5,
        "tb": 26.0,
        "humidity": 60.5,
        "gasCon": 50.0,
        "electricQuantity": 85,           â† åº”è¯¥æœ‰è¿™ä¸ªå­—æ®µï¼
        "warningStatus": 0,
        "outageState": 0,
        "gasConStatus": 0,
        "createdAt": "2024-10-18 14:30:00",
        "updatedAt": null
      }
    ],
    "total": 4
  }
}
```

---

## ğŸ“‹ æ£€æŸ¥æ¸…å•

- [x] Device å®ä½“ç±»æ·»åŠ  electricQuantity å­—æ®µ
- [x] DeviceMapper.xml æ·»åŠ å­—æ®µæ˜ å°„
- [x] æ•°æ®åº“è¡¨æ·»åŠ  electric_quantity å­—æ®µ
- [x] æµ‹è¯•æ•°æ®åŒ…å«ç”µé‡å€¼
- [x] åˆ›å»ºæ•°æ®åº“æ›´æ–°è„šæœ¬
- [x] ä»£ç æ—  linter é”™è¯¯

---

## ğŸ‰ å®Œæˆï¼

ç°åœ¨ `/device/list` æ¥å£ä¼šè¿”å›å®Œæ•´çš„è®¾å¤‡ä¿¡æ¯ï¼ŒåŒ…æ‹¬ç”µé‡å­—æ®µã€‚

**å‰ç«¯å¯ä»¥æ­£å¸¸æ˜¾ç¤ºï¼š**
- ğŸ”‹ ç”µé‡çŠ¶æ€å›¾æ ‡ï¼ˆå……è¶³/ä¸è¶³ï¼‰
- ğŸ“Š ç”µé‡ç™¾åˆ†æ¯”æ•°å€¼

---

## ğŸ“ åˆ›å»ºçš„æ–‡ä»¶

- âœ… `update_add_electric_quantity.sql` - æ•°æ®åº“æ›´æ–°è„šæœ¬
- âœ… `æ·»åŠ ç”µé‡å­—æ®µè¯´æ˜.md` - æœ¬æ–‡æ¡£

---

## ğŸš€ ä¸‹ä¸€æ­¥

1. **æ›´æ–°æ•°æ®åº“** - æ‰§è¡Œ SQL è„šæœ¬æ·»åŠ å­—æ®µ
2. **é‡å¯åç«¯** - `mvn spring-boot:run`
3. **æµ‹è¯•æ¥å£** - éªŒè¯è¿”å›å€¼åŒ…å« electricQuantity
4. **è¿æ¥å‰ç«¯** - å‰ç«¯åº”è¯¥èƒ½æ­£å¸¸æ˜¾ç¤ºç”µé‡äº†

ç«‹å³æ‰§è¡Œæ•°æ®åº“æ›´æ–°è„šæœ¬å§ï¼ğŸ”‹

