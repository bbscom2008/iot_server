# IoT é¡¹ç›®æ‰“åŒ…éƒ¨ç½²æŒ‡å—

## ğŸ¯ éƒ¨ç½²æµç¨‹æ¦‚è§ˆ

```
1. æœ¬åœ°æ‰“åŒ… â†’ 2. ä¸Šä¼ åˆ°æœåŠ¡å™¨ â†’ 3. é…ç½®ç¯å¢ƒ â†’ 4. è¿è¡ŒæœåŠ¡
```

---

## ğŸ“¦ ç¬¬ä¸€æ­¥ï¼šæœ¬åœ°æ‰“åŒ…

### æ–¹å¼1ï¼šä½¿ç”¨ Maven å‘½ä»¤ï¼ˆæ¨èï¼‰

```bash
# åœ¨é¡¹ç›®æ ¹ç›®å½•æ‰§è¡Œ
mvn clean package -DskipTests

# æˆ–è€…ä¸è·³è¿‡æµ‹è¯•
mvn clean package
```

**æ‰“åŒ…è¿‡ç¨‹ï¼š**
```
[INFO] Building jar: C:\Users\Administrator\IdeaProjects\demo\target\demo-0.0.1-SNAPSHOT.jar
[INFO] BUILD SUCCESS
```

**ç”Ÿæˆçš„æ–‡ä»¶ï¼š**
```
target/demo-0.0.1-SNAPSHOT.jar
```

### æ–¹å¼2ï¼šä½¿ç”¨ IDEï¼ˆIntelliJ IDEAï¼‰

1. å³é”®ç‚¹å‡»é¡¹ç›®
2. é€‰æ‹© **Maven** â†’ **Lifecycle** â†’ **package**
3. æˆ–åœ¨å³ä¾§ Maven é¢æ¿ä¸­ï¼ŒåŒå‡» **Lifecycle** â†’ **package**

### éªŒè¯æ‰“åŒ…ç»“æœ

```bash
# æ£€æŸ¥ jar æ–‡ä»¶æ˜¯å¦ç”Ÿæˆ
ls -lh target/*.jar

# æˆ– Windows
dir target\*.jar
```

**é¢„æœŸçœ‹åˆ°ï¼š**
```
demo-0.0.1-SNAPSHOT.jar  (çº¦ 50-80 MB)
```

---

## ğŸ“¤ ç¬¬äºŒæ­¥ï¼šä¸Šä¼ åˆ°æœåŠ¡å™¨

### æ–¹å¼1ï¼šä½¿ç”¨ SCPï¼ˆLinux/Macï¼‰

```bash
# è¯­æ³•
scp target/demo-0.0.1-SNAPSHOT.jar ç”¨æˆ·å@æœåŠ¡å™¨IP:/home/ç”¨æˆ·/app/

# ç¤ºä¾‹
scp target/demo-0.0.1-SNAPSHOT.jar root@192.168.1.100:/opt/iot-app/
```

### æ–¹å¼2ï¼šä½¿ç”¨ WinSCPï¼ˆWindowsï¼‰

1. ä¸‹è½½å®‰è£… [WinSCP](https://winscp.net/)
2. è¿æ¥åˆ°æœåŠ¡å™¨
3. å°† `target/demo-0.0.1-SNAPSHOT.jar` æ‹–æ‹½ä¸Šä¼ 

### æ–¹å¼3ï¼šä½¿ç”¨ FTP å·¥å…·

- FileZilla
- Xftp
- å…¶ä»– FTP å®¢æˆ·ç«¯

### æ–¹å¼4ï¼šä½¿ç”¨ Gitï¼ˆæ¨èå›¢é˜Ÿåä½œï¼‰

```bash
# æäº¤ä»£ç åˆ° Git ä»“åº“
git add .
git commit -m "IoTç³»ç»Ÿå®Œæˆ"
git push

# åœ¨æœåŠ¡å™¨ä¸Šæ‹‰å–ä»£ç å¹¶æ‰“åŒ…
ssh root@æœåŠ¡å™¨IP
git clone ä½ çš„ä»“åº“åœ°å€
cd é¡¹ç›®ç›®å½•
mvn clean package -DskipTests
```

---

## ğŸ–¥ï¸ ç¬¬ä¸‰æ­¥ï¼šæœåŠ¡å™¨ç¯å¢ƒé…ç½®

### 1. å®‰è£… Java 17

**æ£€æŸ¥æ˜¯å¦å·²å®‰è£…ï¼š**
```bash
java -version
```

**å¦‚æœæœªå®‰è£…ï¼ˆCentOS/RHELï¼‰ï¼š**
```bash
# å®‰è£… OpenJDK 17
sudo yum install java-17-openjdk -y

# æˆ–ä¸‹è½½ Oracle JDK
wget https://download.oracle.com/java/17/latest/jdk-17_linux-x64_bin.tar.gz
tar -xzf jdk-17_linux-x64_bin.tar.gz
sudo mv jdk-17* /usr/local/java17
export JAVA_HOME=/usr/local/java17
export PATH=$JAVA_HOME/bin:$PATH
```

**Ubuntu/Debianï¼š**
```bash
sudo apt update
sudo apt install openjdk-17-jdk -y
```

### 2. å®‰è£… MySQL

**æ£€æŸ¥æ˜¯å¦å·²å®‰è£…ï¼š**
```bash
mysql --version
```

**å¦‚æœæœªå®‰è£…ï¼š**
```bash
# CentOS/RHEL
sudo yum install mysql-server -y
sudo systemctl start mysqld
sudo systemctl enable mysqld

# Ubuntu/Debian
sudo apt install mysql-server -y
sudo systemctl start mysql
sudo systemctl enable mysql
```

### 3. åˆå§‹åŒ–æ•°æ®åº“

```bash
# ä¸Šä¼ æ•°æ®åº“è„šæœ¬åˆ°æœåŠ¡å™¨
scp iot_database_init.sql root@æœåŠ¡å™¨IP:/tmp/

# SSH ç™»å½•æœåŠ¡å™¨
ssh root@æœåŠ¡å™¨IP

# æ‰§è¡Œæ•°æ®åº“åˆå§‹åŒ–
mysql -u root -p < /tmp/iot_database_init.sql
```

### 4. åˆ›å»ºåº”ç”¨ç›®å½•

```bash
# åˆ›å»ºç›®å½•
sudo mkdir -p /opt/iot-app
cd /opt/iot-app

# è®¾ç½®æƒé™
sudo chmod 755 /opt/iot-app
```

---

## âš™ï¸ ç¬¬å››æ­¥ï¼šé…ç½®æ–‡ä»¶

### ä¿®æ”¹ application.propertiesï¼ˆç”Ÿäº§ç¯å¢ƒé…ç½®ï¼‰

åœ¨æœåŠ¡å™¨ä¸Šåˆ›å»ºé…ç½®æ–‡ä»¶ï¼š

```bash
cd /opt/iot-app
vi application.properties
```

**å†…å®¹ï¼š**
```properties
spring.application.name=IoT-System

# MySQL Database Configuration
spring.datasource.url=jdbc:mysql://localhost:3306/iot_system?useSSL=false&serverTimezone=Asia/Shanghai&characterEncoding=utf8
spring.datasource.username=root
spring.datasource.password=ä½ çš„MySQLå¯†ç 
spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver

# MyBatis Configuration
mybatis.mapper-locations=classpath:mapper/*.xml
mybatis.type-aliases-package=com.example.demo.entity
mybatis.configuration.map-underscore-to-camel-case=true
# ç”Ÿäº§ç¯å¢ƒå…³é—­SQLæ—¥å¿—
mybatis.configuration.log-impl=org.apache.ibatis.logging.nologging.NoLoggingImpl

# JWT Configuration
jwt.secret=ä½ çš„è¶…çº§å¤æ‚å¯†é’¥-ç”Ÿäº§ç¯å¢ƒ-2024
jwt.expiration=3600000

# Server Port
server.port=8080

# Jackson Configuration
spring.jackson.date-format=yyyy-MM-dd HH:mm:ss
spring.jackson.time-zone=GMT+8

# ç”Ÿäº§ç¯å¢ƒé…ç½®
logging.level.root=INFO
logging.file.name=/opt/iot-app/logs/app.log
```

---

## ğŸš€ ç¬¬äº”æ­¥ï¼šè¿è¡Œåº”ç”¨

### æ–¹å¼1ï¼šç›´æ¥è¿è¡Œï¼ˆæµ‹è¯•ç”¨ï¼‰

```bash
cd /opt/iot-app
java -jar demo-0.0.1-SNAPSHOT.jar
```

### æ–¹å¼2ï¼šåå°è¿è¡Œ

```bash
# ä½¿ç”¨ nohup åå°è¿è¡Œ
nohup java -jar demo-0.0.1-SNAPSHOT.jar > app.log 2>&1 &

# æŸ¥çœ‹è¿›ç¨‹
ps -ef | grep demo

# æŸ¥çœ‹æ—¥å¿—
tail -f app.log
```

### æ–¹å¼3ï¼šä½¿ç”¨è‡ªå®šä¹‰é…ç½®æ–‡ä»¶

```bash
java -jar demo-0.0.1-SNAPSHOT.jar --spring.config.location=/opt/iot-app/application.properties
```

### æ–¹å¼4ï¼šæŒ‡å®šJVMå‚æ•°ï¼ˆæ¨èç”Ÿäº§ç¯å¢ƒï¼‰

```bash
java -Xms512m -Xmx1024m \
  -jar demo-0.0.1-SNAPSHOT.jar \
  --spring.config.location=/opt/iot-app/application.properties \
  > app.log 2>&1 &
```

**å‚æ•°è¯´æ˜ï¼š**
- `-Xms512m` - åˆå§‹å †å†…å­˜ 512MB
- `-Xmx1024m` - æœ€å¤§å †å†…å­˜ 1GB
- `> app.log` - è¾“å‡ºé‡å®šå‘åˆ°æ—¥å¿—æ–‡ä»¶
- `2>&1` - é”™è¯¯è¾“å‡ºä¹Ÿé‡å®šå‘
- `&` - åå°è¿è¡Œ

---

## ğŸ”§ ç¬¬å…­æ­¥ï¼šé…ç½®å¼€æœºè‡ªå¯ï¼ˆæ¨èï¼‰

### æ–¹å¼1ï¼šä½¿ç”¨ systemdï¼ˆæ¨èï¼‰

åˆ›å»ºæœåŠ¡æ–‡ä»¶ï¼š
```bash
sudo vi /etc/systemd/system/iot-app.service
```

**å†…å®¹ï¼š**
```ini
[Unit]
Description=IoT System Application
After=network.target mysql.service

[Service]
Type=simple
User=root
WorkingDirectory=/opt/iot-app
ExecStart=/usr/bin/java -Xms512m -Xmx1024m -jar /opt/iot-app/demo-0.0.1-SNAPSHOT.jar --spring.config.location=/opt/iot-app/application.properties
Restart=on-failure
RestartSec=10
StandardOutput=append:/opt/iot-app/logs/app.log
StandardError=append:/opt/iot-app/logs/error.log

[Install]
WantedBy=multi-user.target
```

**å¯ç”¨å¹¶å¯åŠ¨æœåŠ¡ï¼š**
```bash
# é‡æ–°åŠ è½½ systemd
sudo systemctl daemon-reload

# å¯åŠ¨æœåŠ¡
sudo systemctl start iot-app

# è®¾ç½®å¼€æœºè‡ªå¯
sudo systemctl enable iot-app

# æŸ¥çœ‹çŠ¶æ€
sudo systemctl status iot-app

# æŸ¥çœ‹æ—¥å¿—
sudo journalctl -u iot-app -f
```

**å¸¸ç”¨å‘½ä»¤ï¼š**
```bash
sudo systemctl start iot-app    # å¯åŠ¨
sudo systemctl stop iot-app     # åœæ­¢
sudo systemctl restart iot-app  # é‡å¯
sudo systemctl status iot-app   # çŠ¶æ€
```

---

## ğŸ”¥ ç¬¬ä¸ƒæ­¥ï¼šé…ç½®é˜²ç«å¢™

### å¼€æ”¾ 8080 ç«¯å£

**CentOS/RHELï¼ˆfirewalldï¼‰ï¼š**
```bash
sudo firewall-cmd --permanent --add-port=8080/tcp
sudo firewall-cmd --reload
```

**Ubuntuï¼ˆufwï¼‰ï¼š**
```bash
sudo ufw allow 8080/tcp
sudo ufw reload
```

**äº‘æœåŠ¡å™¨ï¼ˆé˜¿é‡Œäº‘/è…¾è®¯äº‘ï¼‰ï¼š**
- ç™»å½•æ§åˆ¶å°
- å®‰å…¨ç»„è§„åˆ™
- æ·»åŠ å…¥ç«™è§„åˆ™ï¼šç«¯å£ 8080

---

## ğŸŒ ç¬¬å…«æ­¥ï¼šé…ç½® Nginx åå‘ä»£ç†ï¼ˆå¯é€‰ï¼‰

### å®‰è£… Nginx

```bash
# CentOS/RHEL
sudo yum install nginx -y

# Ubuntu/Debian
sudo apt install nginx -y
```

### é…ç½®åå‘ä»£ç†

```bash
sudo vi /etc/nginx/conf.d/iot-app.conf
```

**å†…å®¹ï¼š**
```nginx
server {
    listen 80;
    server_name yourdomain.com;  # ä½ çš„åŸŸå

    location / {
        proxy_pass http://localhost:8080;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }
}
```

**å¯åŠ¨ Nginxï¼š**
```bash
sudo systemctl start nginx
sudo systemctl enable nginx
```

**é…ç½® HTTPSï¼ˆå¯é€‰ï¼‰ï¼š**
```bash
# ä½¿ç”¨ Let's Encrypt å…è´¹è¯ä¹¦
sudo yum install certbot python3-certbot-nginx -y
sudo certbot --nginx -d yourdomain.com
```

---

## ğŸ“Š ç¬¬ä¹æ­¥ï¼šéªŒè¯éƒ¨ç½²

### 1. æ£€æŸ¥æœåŠ¡æ˜¯å¦è¿è¡Œ

```bash
# æ£€æŸ¥è¿›ç¨‹
ps -ef | grep demo

# æ£€æŸ¥ç«¯å£
netstat -tlnp | grep 8080
# æˆ–
ss -tlnp | grep 8080
```

### 2. æµ‹è¯•æ¥å£

```bash
# åœ¨æœåŠ¡å™¨ä¸Šæµ‹è¯•
curl http://localhost:8080/user/login \
  -H "Content-Type: application/json" \
  -d '{"phone":"13800138000","password":"123456"}'

# ä»å¤–ç½‘æµ‹è¯•
curl http://ä½ çš„æœåŠ¡å™¨IP:8080/user/login \
  -H "Content-Type: application/json" \
  -d '{"phone":"13800138000","password":"123456"}'
```

### 3. æŸ¥çœ‹æ—¥å¿—

```bash
# å¦‚æœä½¿ç”¨ nohup
tail -f /opt/iot-app/app.log

# å¦‚æœä½¿ç”¨ systemd
sudo journalctl -u iot-app -f
```

---

## ğŸ› ï¸ å¸¸ç”¨éƒ¨ç½²è„šæœ¬

### éƒ¨ç½²è„šæœ¬ deploy.sh

åˆ›å»ºè‡ªåŠ¨åŒ–éƒ¨ç½²è„šæœ¬ï¼š

```bash
#!/bin/bash

# IoT ç³»ç»Ÿéƒ¨ç½²è„šæœ¬

APP_NAME="demo-0.0.1-SNAPSHOT.jar"
APP_DIR="/opt/iot-app"
CONFIG_FILE="$APP_DIR/application.properties"
LOG_FILE="$APP_DIR/app.log"

echo "=== IoT ç³»ç»Ÿéƒ¨ç½²å¼€å§‹ ==="

# 1. åœæ­¢æ—§æœåŠ¡
echo "æ­¥éª¤1: åœæ­¢æ—§æœåŠ¡..."
PID=$(ps -ef | grep $APP_NAME | grep -v grep | awk '{print $2}')
if [ -n "$PID" ]; then
    kill -9 $PID
    echo "å·²åœæ­¢è¿›ç¨‹: $PID"
else
    echo "æ²¡æœ‰è¿è¡Œä¸­çš„æœåŠ¡"
fi

# 2. å¤‡ä»½æ—§ç‰ˆæœ¬
echo "æ­¥éª¤2: å¤‡ä»½æ—§ç‰ˆæœ¬..."
if [ -f "$APP_DIR/$APP_NAME" ]; then
    mv "$APP_DIR/$APP_NAME" "$APP_DIR/$APP_NAME.bak.$(date +%Y%m%d%H%M%S)"
    echo "æ—§ç‰ˆæœ¬å·²å¤‡ä»½"
fi

# 3. å¤åˆ¶æ–°ç‰ˆæœ¬
echo "æ­¥éª¤3: éƒ¨ç½²æ–°ç‰ˆæœ¬..."
cp target/$APP_NAME $APP_DIR/
echo "æ–°ç‰ˆæœ¬å·²å¤åˆ¶"

# 4. å¯åŠ¨æœåŠ¡
echo "æ­¥éª¤4: å¯åŠ¨æœåŠ¡..."
cd $APP_DIR
nohup java -Xms512m -Xmx1024m \
  -jar $APP_NAME \
  --spring.config.location=$CONFIG_FILE \
  > $LOG_FILE 2>&1 &

echo "æœåŠ¡å·²å¯åŠ¨"

# 5. ç­‰å¾…æœåŠ¡å¯åŠ¨
echo "æ­¥éª¤5: ç­‰å¾…æœåŠ¡å¯åŠ¨..."
sleep 5

# 6. æ£€æŸ¥æœåŠ¡çŠ¶æ€
PID=$(ps -ef | grep $APP_NAME | grep -v grep | awk '{print $2}')
if [ -n "$PID" ]; then
    echo "âœ… æœåŠ¡å¯åŠ¨æˆåŠŸï¼Œè¿›ç¨‹ID: $PID"
    echo "æŸ¥çœ‹æ—¥å¿—: tail -f $LOG_FILE"
else
    echo "âŒ æœåŠ¡å¯åŠ¨å¤±è´¥ï¼Œè¯·æŸ¥çœ‹æ—¥å¿—"
    tail -50 $LOG_FILE
fi

echo "=== éƒ¨ç½²å®Œæˆ ==="
```

**ä½¿ç”¨è„šæœ¬ï¼š**
```bash
chmod +x deploy.sh
./deploy.sh
```

---

## ğŸ³ ä½¿ç”¨ Docker éƒ¨ç½²ï¼ˆæ¨èï¼‰

### 1. åˆ›å»º Dockerfile

```dockerfile
FROM openjdk:17-jdk-slim

LABEL maintainer="your-email@example.com"

# è®¾ç½®å·¥ä½œç›®å½•
WORKDIR /app

# å¤åˆ¶ jar æ–‡ä»¶
COPY target/demo-0.0.1-SNAPSHOT.jar app.jar

# æš´éœ²ç«¯å£
EXPOSE 8080

# è®¾ç½®ç¯å¢ƒå˜é‡
ENV JAVA_OPTS="-Xms512m -Xmx1024m"

# å¯åŠ¨åº”ç”¨
ENTRYPOINT ["sh", "-c", "java $JAVA_OPTS -jar app.jar"]
```

### 2. åˆ›å»º docker-compose.yml

```yaml
version: '3.8'

services:
  mysql:
    image: mysql:8.0
    container_name: iot-mysql
    environment:
      MYSQL_ROOT_PASSWORD: root123456
      MYSQL_DATABASE: iot_system
    ports:
      - "3306:3306"
    volumes:
      - mysql-data:/var/lib/mysql
      - ./iot_database_init.sql:/docker-entrypoint-initdb.d/init.sql
    networks:
      - iot-network

  app:
    build: .
    container_name: iot-app
    ports:
      - "8080:8080"
    depends_on:
      - mysql
    environment:
      SPRING_DATASOURCE_URL: jdbc:mysql://mysql:3306/iot_system?useSSL=false&serverTimezone=Asia/Shanghai
      SPRING_DATASOURCE_USERNAME: root
      SPRING_DATASOURCE_PASSWORD: root123456
    networks:
      - iot-network
    restart: unless-stopped

networks:
  iot-network:
    driver: bridge

volumes:
  mysql-data:
```

### 3. ä½¿ç”¨ Docker Compose éƒ¨ç½²

```bash
# æ„å»ºå¹¶å¯åŠ¨
docker-compose up -d

# æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f app

# åœæ­¢æœåŠ¡
docker-compose down

# é‡å¯æœåŠ¡
docker-compose restart app
```

---

## ğŸ“ é¡¹ç›®é…ç½®æ–‡ä»¶ç®¡ç†

### å¤šç¯å¢ƒé…ç½®

#### application.propertiesï¼ˆé»˜è®¤ï¼‰
```properties
spring.profiles.active=prod
```

#### application-dev.propertiesï¼ˆå¼€å‘ç¯å¢ƒï¼‰
```properties
spring.datasource.url=jdbc:mysql://localhost:3306/iot_system...
jwt.expiration=60000
mybatis.configuration.log-impl=org.apache.ibatis.logging.stdout.StdOutImpl
```

#### application-prod.propertiesï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰
```properties
spring.datasource.url=jdbc:mysql://ç”Ÿäº§æ•°æ®åº“IP:3306/iot_system...
jwt.expiration=3600000
mybatis.configuration.log-impl=org.apache.ibatis.logging.nologging.NoLoggingImpl
logging.level.root=WARN
```

**å¯åŠ¨æ—¶æŒ‡å®šç¯å¢ƒï¼š**
```bash
java -jar app.jar --spring.profiles.active=prod
```

---

## ğŸ” ç›‘æ§å’Œç®¡ç†

### 1. æŸ¥çœ‹è¿›ç¨‹

```bash
ps -ef | grep demo
```

### 2. æŸ¥çœ‹æ—¥å¿—

```bash
tail -f /opt/iot-app/app.log

# å®æ—¶æŸ¥çœ‹é”™è¯¯æ—¥å¿—
tail -f /opt/iot-app/app.log | grep ERROR
```

### 3. åœæ­¢åº”ç”¨

```bash
# æŸ¥æ‰¾è¿›ç¨‹ID
PID=$(ps -ef | grep demo-0.0.1-SNAPSHOT.jar | grep -v grep | awk '{print $2}')

# ä¼˜é›…åœæ­¢
kill -15 $PID

# å¼ºåˆ¶åœæ­¢
kill -9 $PID
```

### 4. é‡å¯åº”ç”¨

```bash
# åœæ­¢
kill $(ps -ef | grep demo-0.0.1-SNAPSHOT.jar | grep -v grep | awk '{print $2}')

# å¯åŠ¨
nohup java -jar /opt/iot-app/demo-0.0.1-SNAPSHOT.jar > /opt/iot-app/app.log 2>&1 &
```

---

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–é…ç½®

### JVM å‚æ•°ä¼˜åŒ–

```bash
java -server \
  -Xms1g -Xmx2g \
  -XX:+UseG1GC \
  -XX:MaxGCPauseMillis=200 \
  -XX:+HeapDumpOnOutOfMemoryError \
  -XX:HeapDumpPath=/opt/iot-app/dumps/ \
  -Dspring.profiles.active=prod \
  -jar demo-0.0.1-SNAPSHOT.jar
```

**å‚æ•°è¯´æ˜ï¼š**
- `-Xms1g` - åˆå§‹å †å†…å­˜ 1GB
- `-Xmx2g` - æœ€å¤§å †å†…å­˜ 2GB
- `-XX:+UseG1GC` - ä½¿ç”¨ G1 åƒåœ¾å›æ”¶å™¨
- `-XX:+HeapDumpOnOutOfMemoryError` - OOM æ—¶ç”Ÿæˆå †è½¬å‚¨

---

## ğŸ›¡ï¸ å®‰å…¨é…ç½®

### 1. ä¿®æ”¹é»˜è®¤ç«¯å£

```properties
server.port=8888  # æ”¹ä¸ºå…¶ä»–ç«¯å£
```

### 2. é™åˆ¶è®¿é—® IPï¼ˆNginxï¼‰

```nginx
location / {
    allow 192.168.1.0/24;  # å…è®¸å†…ç½‘
    deny all;              # æ‹’ç»å…¶ä»–
    proxy_pass http://localhost:8080;
}
```

### 3. é…ç½® SSL/HTTPS

```nginx
server {
    listen 443 ssl;
    server_name yourdomain.com;
    
    ssl_certificate /path/to/cert.pem;
    ssl_certificate_key /path/to/key.pem;
    
    location / {
        proxy_pass http://localhost:8080;
    }
}
```

---

## ğŸ“‹ éƒ¨ç½²æ£€æŸ¥æ¸…å•

### æ‰“åŒ…å‰æ£€æŸ¥
- [ ] ä¿®æ”¹ JWT å¯†é’¥ä¸ºå¤æ‚å­—ç¬¦ä¸²
- [ ] ä¿®æ”¹ Token æœ‰æ•ˆæœŸä¸ºåˆé€‚å€¼ï¼ˆå¦‚ 1 å°æ—¶ï¼‰
- [ ] å…³é—­ SQL æ—¥å¿—è¾“å‡º
- [ ] è®¾ç½®æ—¥å¿—çº§åˆ«ä¸º WARN æˆ– INFO
- [ ] æ£€æŸ¥æ•°æ®åº“è¿æ¥é…ç½®

### æœåŠ¡å™¨å‡†å¤‡
- [ ] Java 17 å·²å®‰è£…
- [ ] MySQL å·²å®‰è£…å¹¶è¿è¡Œ
- [ ] æ•°æ®åº“å·²åˆå§‹åŒ–
- [ ] é˜²ç«å¢™å·²å¼€æ”¾ç«¯å£
- [ ] åˆ›å»ºåº”ç”¨ç›®å½•

### éƒ¨ç½²åæ£€æŸ¥
- [ ] æœåŠ¡æ­£å¸¸å¯åŠ¨
- [ ] è¿›ç¨‹å­˜åœ¨
- [ ] ç«¯å£ç›‘å¬æ­£å¸¸
- [ ] æ¥å£å¯ä»¥è®¿é—®
- [ ] æ—¥å¿—æ— é”™è¯¯
- [ ] å‰ç«¯å¯ä»¥è¿æ¥

---

## ğŸ¯ å®Œæ•´éƒ¨ç½²å‘½ä»¤ï¼ˆå¤åˆ¶ç²˜è´´ï¼‰

```bash
# 1. æœ¬åœ°æ‰“åŒ…
mvn clean package -DskipTests

# 2. ä¸Šä¼ åˆ°æœåŠ¡å™¨
scp target/demo-0.0.1-SNAPSHOT.jar root@ä½ çš„æœåŠ¡å™¨IP:/opt/iot-app/
scp iot_database_init.sql root@ä½ çš„æœåŠ¡å™¨IP:/tmp/

# 3. SSH ç™»å½•æœåŠ¡å™¨
ssh root@ä½ çš„æœåŠ¡å™¨IP

# 4. åˆå§‹åŒ–æ•°æ®åº“
mysql -u root -p < /tmp/iot_database_init.sql

# 5. å¯åŠ¨åº”ç”¨
cd /opt/iot-app
nohup java -Xms512m -Xmx1024m -jar demo-0.0.1-SNAPSHOT.jar > app.log 2>&1 &

# 6. æŸ¥çœ‹æ—¥å¿—
tail -f app.log

# 7. æµ‹è¯•æ¥å£
curl http://localhost:8080/user/login \
  -H "Content-Type: application/json" \
  -d '{"phone":"13800138000","password":"123456"}'
```

---

## ğŸ“š ç›¸å…³æ–‡ä»¶

æˆ‘ä¼šåˆ›å»ºä»¥ä¸‹éƒ¨ç½²æ–‡ä»¶ï¼š
- âœ… `Dockerfile` - Docker é•œåƒé…ç½®
- âœ… `docker-compose.yml` - Docker Compose é…ç½®
- âœ… `deploy.sh` - è‡ªåŠ¨åŒ–éƒ¨ç½²è„šæœ¬
- âœ… `iot-app.service` - systemd æœåŠ¡æ–‡ä»¶
- âœ… `nginx.conf` - Nginx é…ç½®ç¤ºä¾‹

---

## ğŸ‰ éƒ¨ç½²å®Œæˆï¼

é€‰æ‹©é€‚åˆä½ çš„éƒ¨ç½²æ–¹å¼ï¼š
- **ç®€å•éƒ¨ç½²** â†’ nohup åå°è¿è¡Œ
- **ç”Ÿäº§éƒ¨ç½²** â†’ systemd æœåŠ¡
- **å®¹å™¨åŒ–éƒ¨ç½²** â†’ Docker Composeï¼ˆæ¨èï¼‰

**æ¥ä¸‹æ¥æˆ‘ä¼šåˆ›å»ºæ‰€æœ‰éœ€è¦çš„é…ç½®æ–‡ä»¶ï¼**

