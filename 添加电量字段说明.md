# æ·»åŠ ç”µé‡å­—æ®µ (electricQuantity)

## ğŸ¯ é—®é¢˜æè¿°

å‰ç«¯ UniApp é¡¹ç›®åœ¨æ˜¾ç¤ºè®¾å¤‡ä¿¡æ¯æ—¶ä½¿ç”¨äº† `electricQuantity` å­—æ®µï¼ˆç”µé‡å€¼ï¼‰ï¼Œä½†åç«¯æ²¡æœ‰è¿”å›è¿™ä¸ªå­—æ®µã€‚

**å‰ç«¯ä½¿ç”¨ä½ç½®ï¼š**
- `components/tab-views/home.vue` - ç¬¬62è¡Œï¼šç”µé‡çŠ¶æ€å›¾æ ‡
- `pages/equipmentDetails/equipmentDetails.vue` - ç¬¬42è¡Œï¼šè®¾å¤‡è¯¦æƒ…ç”µé‡æ˜¾ç¤º
- `pages/particulars/particulars.vue` - ç¬¬26è¡Œï¼šè®¾å¤‡ç”µé‡ç™¾åˆ†æ¯”

---

## âœ… å·²å®Œæˆçš„ä¿®æ”¹

### 1. Device å®ä½“ç±»

**æ–‡ä»¶ï¼š** `src/main/java/com/example/demo/entity/Device.java`

**æ·»åŠ å­—æ®µï¼š**
```java
private Integer electricQuantity; // ç”µé‡ï¼ˆ0-100ï¼‰
```

### 2. DeviceMapper.xml

**æ–‡ä»¶ï¼š** `src/main/resources/mapper/DeviceMapper.xml`

**æ·»åŠ æ˜ å°„ï¼š**
```xml
<result column="electric_quantity" property="electricQuantity" jdbcType="INTEGER"/>
```

### 3. æ•°æ®åº“è¡¨

**æ–‡ä»¶ï¼š** `iot_database_init.sql`

**æ·»åŠ å­—æ®µï¼š**
```sql
electric_quantity INT DEFAULT 100 COMMENT 'ç”µé‡ï¼ˆ0-100ï¼‰',
```

**æµ‹è¯•æ•°æ®ï¼š**
- DEV001: 85%ï¼ˆç”µé‡å……è¶³ï¼‰
- DEV002: 93%ï¼ˆç”µé‡å……è¶³ï¼‰
- DEV003: 15%ï¼ˆç”µé‡ä½ï¼Œéœ€è¦å…³æ³¨ï¼‰
- DEV004: 72%ï¼ˆç”µé‡æ­£å¸¸ï¼‰

---

## ğŸ”„ æ›´æ–°ç°æœ‰æ•°æ®åº“

å¦‚æœä½ å·²ç»åˆ›å»ºäº†æ•°æ®åº“ï¼Œä½¿ç”¨ä»¥ä¸‹æ–¹æ³•æ·»åŠ å­—æ®µï¼š

### æ–¹æ³•1ï¼šé‡æ–°åˆå§‹åŒ–æ•°æ®åº“ï¼ˆæ¨èï¼Œæ•°æ®ä¼šæ¸…ç©ºï¼‰

```bash
# åˆ é™¤æ—§æ•°æ®åº“ï¼Œé‡æ–°åˆ›å»º
mysql -u root -p

DROP DATABASE IF EXISTS iot_system;
source iot_database_init.sql
```

### æ–¹æ³•2ï¼šåªæ·»åŠ å­—æ®µï¼ˆä¿ç•™ç°æœ‰æ•°æ®ï¼‰

```bash
# æ‰§è¡Œæ›´æ–°è„šæœ¬
mysql -u root -p < update_add_electric_quantity.sql
```

æˆ–æ‰‹åŠ¨æ‰§è¡Œï¼š

```sql
USE iot_system;

-- æ·»åŠ ç”µé‡å­—æ®µ
ALTER TABLE devices 
ADD COLUMN electric_quantity INT DEFAULT 100 COMMENT 'ç”µé‡ï¼ˆ0-100ï¼‰' 
AFTER gas_con;

-- ä¸ºç°æœ‰æ•°æ®è®¾ç½®ç”µé‡å€¼
UPDATE devices SET electric_quantity = 85 WHERE electric_quantity IS NULL;

-- æŸ¥çœ‹ç»“æœ
SELECT id, device_num, device_name, electric_quantity FROM devices;
```

---

## ğŸ“Š å­—æ®µè¯´æ˜

### electricQuantityï¼ˆç”µé‡ï¼‰

| å±æ€§ | å€¼ |
|------|-----|
| **ç±»å‹** | Integer |
| **èŒƒå›´** | 0-100 |
| **å•ä½** | ç™¾åˆ†æ¯”ï¼ˆ%ï¼‰ |
| **é»˜è®¤å€¼** | 100 |
| **è¯´æ˜** | è®¾å¤‡ç”µæ± ç”µé‡ï¼Œ0è¡¨ç¤ºæ— ç”µï¼Œ100è¡¨ç¤ºæ»¡ç”µ |

### ç”µé‡çŠ¶æ€åˆ¤æ–­

**å‰ç«¯é€»è¾‘ï¼š**
```javascript
// electricQuantity > 20 â†’ ç”µé‡å……è¶³ï¼ˆç»¿è‰²ï¼‰
// electricQuantity <= 20 â†’ ç”µé‡ä¸è¶³ï¼ˆçº¢è‰²è­¦å‘Šï¼‰

if (item.electricQuantity > 20) {
    æ˜¾ç¤º"ç”µé‡å……è¶³"ï¼ˆç»¿è‰²å›¾æ ‡ï¼‰
} else {
    æ˜¾ç¤º"ç”µé‡ä¸è¶³"ï¼ˆçº¢è‰²å›¾æ ‡ï¼‰
}
```

---

## ğŸ§ª æµ‹è¯•éªŒè¯

### 1. é‡å¯åç«¯æœåŠ¡

```bash
mvn spring-boot:run
```

### 2. ç™»å½•è·å– Token

```bash
curl -X POST http://localhost:8080/user/login \
  -H "Content-Type: application/json" \
  -d '{"phone":"13800138000","password":"123456"}'
```

### 3. è·å–è®¾å¤‡åˆ—è¡¨ï¼ˆæ£€æŸ¥æ˜¯å¦åŒ…å« electricQuantityï¼‰

```bash
curl -X GET "http://localhost:8080/device/list?pageNum=1&pageSize=10" \
  -H "Authorization: ä½ çš„token"
```

**æ£€æŸ¥å“åº”ä¸­æ˜¯å¦åŒ…å«ï¼š**
```json
{
  "code": 200,
  "msg": "success",
  "data": {
    "list": [
      {
        "id": 1,
        "deviceNum": "DEV001",
        "deviceName": "1å·çŒªèˆæŠ¥è­¦å™¨",
        "ta": 25.5,
        "humidity": 60.5,
        "electricQuantity": 85,    â† åº”è¯¥æœ‰è¿™ä¸ªå­—æ®µï¼
        ...
      }
    ],
    "total": 4
  }
}
```

---

## ğŸ“‹ å®Œæ•´çš„è®¾å¤‡å­—æ®µæ¸…å•

| å­—æ®µå | ç±»å‹ | è¯´æ˜ | å‰ç«¯æ˜¾ç¤º |
|--------|------|------|---------|
| id | Long | è®¾å¤‡ID | - |
| deviceNum | String | è®¾å¤‡ç¼–å· | âœ… |
| deviceName | String | è®¾å¤‡åç§° | âœ… |
| deviceType | Integer | è®¾å¤‡ç±»å‹ | âœ… |
| breedType | Integer | å…»æ®–ç±»å‹ | âœ… |
| deviceLineState | Integer | åœ¨çº¿çŠ¶æ€ | âœ… |
| signal | Integer | ä¿¡å·å¼ºåº¦ | âœ… |
| ta | Decimal | æ¸©åº¦A | âœ… |
| tb | Decimal | æ¸©åº¦B | âœ… |
| humidity | Decimal | æ¹¿åº¦ | âœ… |
| gasCon | Decimal | æ°”ä½“æµ“åº¦ | âœ… |
| **electricQuantity** | **Integer** | **ç”µé‡** | **âœ… æ–°å¢** |
| warningStatus | Integer | æŠ¥è­¦çŠ¶æ€ | âœ… |
| outageState | Integer | æ–­ç”µçŠ¶æ€ | âœ… |
| gasConStatus | Integer | æ°”ä½“æŠ¥è­¦çŠ¶æ€ | âœ… |

---

## ğŸ¨ å‰ç«¯æ˜¾ç¤ºæ•ˆæœ

### è®¾å¤‡åˆ—è¡¨é¡µï¼ˆhome.vueï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ è®¾å¤‡ç¼–å·: DEV001                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ“¶ ç½‘ç»œæ­£å¸¸  ğŸ”‹ ç”µé‡å……è¶³  ğŸŸ¢ åœ¨çº¿ â”‚  â† electricQuantity ç”¨äºæ˜¾ç¤ºç”µé‡çŠ¶æ€
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  25.5Â°C    60.5%     50ppm      â”‚
â”‚  æ¸©åº¦      æ¹¿åº¦      æ°”ä½“         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### è®¾å¤‡è¯¦æƒ…é¡µ

```
ç”µé‡ï¼š93%  â† æ˜¾ç¤º electricQuantity çš„å€¼
```

---

## ğŸ“ ä¿®æ”¹çš„æ–‡ä»¶

| æ–‡ä»¶ | ä¿®æ”¹å†…å®¹ | çŠ¶æ€ |
|------|----------|------|
| `Device.java` | æ·»åŠ  electricQuantity å­—æ®µ | âœ… |
| `DeviceMapper.xml` | æ·»åŠ å­—æ®µæ˜ å°„ | âœ… |
| `iot_database_init.sql` | æ·»åŠ è¡¨å­—æ®µå’Œæµ‹è¯•æ•°æ® | âœ… |
| `update_add_electric_quantity.sql` | åˆ›å»ºæ›´æ–°è„šæœ¬ï¼ˆç»™å·²æœ‰æ•°æ®åº“ç”¨ï¼‰ | âœ… |

---

## ğŸš€ ç«‹å³åº”ç”¨

### å¦‚æœæ˜¯æ–°å»ºæ•°æ®åº“ï¼š

```bash
mysql -u root -p < iot_database_init.sql
```

### å¦‚æœæ•°æ®åº“å·²å­˜åœ¨ï¼š

```bash
mysql -u root -p < update_add_electric_quantity.sql
```

### ç„¶åé‡å¯åç«¯ï¼š

```bash
mvn spring-boot:run
```

---

## âœ… éªŒè¯æˆåŠŸæ ‡å¿—

è°ƒç”¨è®¾å¤‡åˆ—è¡¨æ¥å£ï¼Œå“åº”ä¸­åº”è¯¥åŒ…å« `electricQuantity` å­—æ®µï¼š

```json
{
  "deviceNum": "DEV001",
  "electricQuantity": 85,   â† æœ‰è¿™ä¸ªå­—æ®µå°±å¯¹äº†ï¼
  "signal": 3,
  "ta": 25.5
}
```

---

## ğŸ‰ é—®é¢˜è§£å†³ï¼

ç°åœ¨è®¾å¤‡åˆ—è¡¨æ¥å£ä¼šè¿”å›å®Œæ•´çš„æ•°æ®ï¼ŒåŒ…æ‹¬ï¼š
- âœ… æ‰€æœ‰ä¼ æ„Ÿå™¨æ•°æ®ï¼ˆæ¸©åº¦ã€æ¹¿åº¦ã€æ°”ä½“ï¼‰
- âœ… **ç”µé‡æ•°æ®** `electricQuantity`
- âœ… çŠ¶æ€æ•°æ®ï¼ˆåœ¨çº¿ã€ä¿¡å·ã€æŠ¥è­¦ï¼‰

**å‰ç«¯ç°åœ¨å¯ä»¥æ­£å¸¸æ˜¾ç¤ºç”µé‡çŠ¶æ€äº†ï¼** ğŸ”‹âœ…

