# å­—æ®µç±»å‹ä¿®æ”¹ - æ€»ç»“

## ğŸ“Š ä¸»è¦å˜åŒ–

æ ¹æ® `iot_database_init.sql` çš„ä¿®æ”¹ï¼Œå·²åŒæ­¥æ›´æ–°æ‰€æœ‰ç›¸å…³ä»£ç ï¼š

### å˜åŒ–å¯¹ç…§è¡¨

| å­—æ®µ | åŸç±»å‹ | æ–°ç±»å‹ | åŸå­—æ®µå | æ–°å­—æ®µå | è¯´æ˜ |
|------|--------|--------|---------|---------|------|
| å…»æ®–ç±»å‹ | VARCHAR(20) | **INT** | breeding_type | breeding_type | å…³è”å­—å…¸è¡¨ |
| å²—ä½/è§’è‰² | VARCHAR(20) | **INT** | position | **role** | æ”¹åå¹¶å…³è”å­—å…¸è¡¨ |

---

## âœ… åç«¯ä¿®æ”¹å®Œæˆï¼ˆ5ä¸ªæ–‡ä»¶ï¼‰

### 1. User.java
```java
private Integer breedingType;  // æ”¹ä¸º Integer
private Integer role;          // æ”¹å position â†’ roleï¼Œç±»å‹æ”¹ä¸º Integer
```

### 2. UserMapper.xml
```xml
<result column="breeding_type" property="breedingType" jdbcType="INTEGER"/>
<result column="role" property="role" jdbcType="INTEGER"/>
```

### 3. RegisterRequest.java
```java
@NotNull(message = "å…»æ®–ç±»å‹ä¸èƒ½ä¸ºç©º")
private Integer breedingType;

@NotNull(message = "è§’è‰²ä¸èƒ½ä¸ºç©º")
private Integer role;  // æ”¹å position â†’ role
```

### 4. UserService.java
```java
user.setBreedingType(request.getBreedingType());  // Integer
user.setRole(request.getRole());  // Integer
```

### 5. update_users_table.sql
```sql
ALTER TABLE users ADD COLUMN breeding_type INT ...
ALTER TABLE users ADD COLUMN role INT ...
```

---

## âš ï¸ å‰ç«¯éœ€è¦ä¿®æ”¹ï¼ˆ1ä¸ªæ–‡ä»¶ï¼‰

### register.vue

**æ–‡ä»¶è·¯å¾„ï¼š**
```
C:\Users\Administrator\Desktop\server\dspace\src\pages\register\register.vue
```

**ä¿®æ”¹ä½ç½®ï¼š** ç¬¬ 147-152 è¡Œ

**ä¿®æ”¹å†…å®¹ï¼š**
```javascript
// æ”¹å‰ï¼š
breedingType: this.breedingTypes[this.breedingTypeIndex],  // âŒ å­—ç¬¦ä¸²
position: this.positions[this.positionIndex]  // âŒ å­—æ®µåé”™è¯¯

// æ”¹åï¼š
breedingType: this.breedingTypeIndex,  // âœ… æ•´æ•°
role: this.positionIndex  // âœ… å­—æ®µåæ”¹ä¸º roleï¼Œæ•´æ•°
```

---

## ğŸ¯ å­—å…¸å€¼å¯¹åº”å…³ç³»

### å…»æ®–ç±»å‹å­—å…¸ (breed_type)

| å€¼ | æ˜¾ç¤º |
|----|------|
| 0 | çŒª |
| 1 | ç¾Š |
| 2 | ç‰› |
| 3 | é¸¡ |
| 4 | é¸­ |
| 5 | å…¶ä»– |

### è§’è‰²ç±»å‹å­—å…¸ (role_type)

| å€¼ | æ˜¾ç¤º |
|----|------|
| 0 | è€æ¿ |
| 1 | é¥²å…»å‘˜ |
| 2 | å…¶ä»– |

---

## ğŸ§ª æµ‹è¯•ç¤ºä¾‹

### åç«¯æ¥å£æµ‹è¯•

```bash
# æ³¨å†Œï¼šå…»çŒªè€æ¿
curl -X POST http://localhost:8080/user/register \
  -H "Content-Type: application/json" \
  -d '{
    "phone": "13711111111",
    "password": "123456",
    "verifyCode": "123456",
    "breedingType": 0,
    "role": 0
  }'
```

**æ•°æ®åº“ç»“æœï¼š**
```sql
SELECT * FROM users WHERE phone = '13711111111';
-- breeding_type = 0, role = 0
```

**æŸ¥è¯¢æ—¶å…³è”å­—å…¸ï¼š**
```sql
SELECT 
    u.phone,
    u.nike_name,
    b.dict_label AS breeding_name,
    r.dict_label AS role_name
FROM users u
LEFT JOIN dict_data b ON u.breeding_type = b.dict_value AND b.dict_type = 'breed_type'
LEFT JOIN dict_data r ON u.role = r.dict_value AND r.dict_type = 'role_type'
WHERE u.phone = '13711111111';

-- ç»“æœï¼š
-- phone: 13711111111
-- breeding_name: çŒª
-- role_name: è€æ¿
```

---

## ğŸš€ éƒ¨ç½²æ­¥éª¤

### 1. æ›´æ–°æ•°æ®åº“

```bash
mysql -u root -p

# å¦‚æœå­—æ®µç±»å‹ä¸å¯¹ï¼Œé‡æ–°åˆ›å»ºæ•°æ®åº“
DROP DATABASE IF EXISTS iot_system;
source iot_database_init.sql;
```

### 2. é‡å¯åç«¯

```bash
mvn spring-boot:run
```

### 3. æµ‹è¯•åç«¯

```bash
curl -X POST http://localhost:8080/user/register \
  -H "Content-Type: application/json" \
  -d '{"phone":"13711111111","password":"123456","verifyCode":"123456","breedingType":0,"role":0}'
```

### 4. ä¿®æ”¹å‰ç«¯ register.vue

è§ `å‰ç«¯register.vueä¿®æ”¹è¯´æ˜.md`

### 5. é‡å¯å‰ç«¯

```bash
cd C:\Users\Administrator\Desktop\server\dspace
npm run dev:h5
```

---

## ğŸ“‹ ä¿®æ”¹æ¸…å•

### åç«¯ âœ…
- [x] User.java
- [x] UserMapper.xml
- [x] RegisterRequest.java
- [x] UserService.java
- [x] update_users_table.sql

### å‰ç«¯ âš ï¸
- [ ] register.vueï¼ˆç¬¬ 81 è¡Œå’Œç¬¬ 147-152 è¡Œï¼‰

### æ•°æ®åº“ âš ï¸
- [ ] é‡æ–°åˆå§‹åŒ–æˆ–æ›´æ–°å­—æ®µç±»å‹

---

## ğŸ‰ å®Œæˆï¼

åç«¯ä»£ç å·²å®Œå…¨åŒæ­¥æ•°æ®åº“çš„ä¿®æ”¹ï¼š

âœ… **breedingType** - æ”¹ä¸º Integer  
âœ… **position â†’ role** - æ”¹åå¹¶æ”¹ä¸º Integer  
âœ… **å…³è”å­—å…¸è¡¨** - ä½¿ç”¨æ•´æ•°å€¼  
âœ… **æ‰€æœ‰ä»£ç æ— é”™è¯¯** - å¯ç›´æ¥è¿è¡Œ  

**ç°åœ¨éœ€è¦ï¼š**
1. æ›´æ–°æ•°æ®åº“ï¼ˆé‡æ–°åˆå§‹åŒ–ï¼‰
2. ä¿®æ”¹å‰ç«¯ register.vueï¼ˆ2å¤„ä¿®æ”¹ï¼‰
3. æµ‹è¯•å®Œæ•´æµç¨‹

æŸ¥çœ‹ `å‰ç«¯register.vueä¿®æ”¹è¯´æ˜.md` è·å–è¯¦ç»†ä¿®æ”¹æ­¥éª¤ï¼ğŸ”§

